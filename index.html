<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HOMI çƒ¤ç¾Šæ´¾å¯¹ç ´å†°æ¸¸æˆ</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
      background: linear-gradient(180deg,#fff5f8 0%,#fff 60%);
      margin:0; padding:20px;
    }
    .container { max-width:700px; margin:0 auto; }
    h1 { text-align:center; margin-bottom:20px; }
    .grid { display:grid; grid-template-columns:repeat(5,1fr); gap:10px; }
    .cell {
      background:#fff;
      border-radius:14px;
      padding:10px;
      min-height:150px;
      display:flex;
      flex-direction:column;
    }
    .cell.done { background:#ffd6e8; }
    .question { font-size:14px; margin-bottom:8px; }
    .name-input { width:100%; padding:6px; border-radius:6px; border:1px solid #ccc; flex-shrink:0; }
    #downloadImage {
      padding:10px 20px;
      font-size:16px;
      border-radius:20px;
      border:none;
      background:#ff6fa5;
      color:#fff;
      cursor:pointer;
      margin:20px auto;
      display:block;
    }
    @media(max-width:768px){ .grid{grid-template-columns:repeat(2,1fr);} }
  </style>
</head>
<body>
  <div class="container" id="container">
    <h1>HOMI çƒ¤ç¾Šæ´¾å¯¹ç ´å†°æ¸¸æˆ</h1>
    <div class="grid" id="grid"></div>
    <button id="downloadImage">ğŸ“· ä¸€é”®ç”Ÿæˆå›¾ç‰‡</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    const questions = [
      "æ‰¾ä¸€ä¸ªå’Œä½ ç©¿åŒé¢œè‰²è¡£æœçš„å¼‚æ€§",
      "ä¼š2ç§ä»¥ä¸Šä¹å™¨çš„äºº",
      "å»è¿‡4ä¸ªä»¥ä¸Šå›½å®¶",
      "ä½ è§‰å¾—å¥½çœ‹çš„å¼‚æ€§",
      "åŒMBTIçš„äºº",
      "ä¼šä¸‰ç§è¯­è¨€çš„äºº",
      "æœ‰ç›¸åŒå…´è¶£çˆ±å¥½çš„äºº",
      "è¹¦æè·³ä¼è¿‡çš„äºº",
      "ä¼šåšé¥­çš„äºº",
      "å…»å® ç‰©çš„äºº",
      "å–œæ¬¢ç”œé£Ÿçš„äºº",
      "æœ€è¿‘ä¸€å¹´æ—…è¡Œè¿‡",
      "çœ‹è¿‡100éƒ¨ç”µå½±",
      "ä¸ä¼šæ¸¸æ³³çš„äºº",
      "å‚åŠ è¿‡3æ¬¡ä»¥ä¸Šç¾¤æ´»åŠ¨çš„äºº",
      "ä¸Šè¿‡ç”µè§†çš„äºº",
      "åŒæ˜Ÿåº§çš„äºº",
      "æœ‰ä¸¤ä¸ªä»¥ä¸Šå…„å¼Ÿå§å¦¹",
      "ä¼šå”±æ­Œçš„äºº",
      "æ¯”ä½ é«˜çš„å¼‚æ€§"
    ];

    const grid = document.getElementById("grid");
    const usedNames = new Set();

    // ç”Ÿæˆæ ¼å­
    questions.forEach(q=>{
      const cell = document.createElement("div"); cell.className="cell";
      const question = document.createElement("div"); question.className="question"; question.textContent = q;
      const input = document.createElement("input"); input.className="name-input"; input.placeholder="å¡«å†™åå­—";
      input.onchange = ()=>{
        const name = input.value.trim();
        if(!name){
          cell.classList.remove("done");
          usedNames.delete(name);
          return;
        }
        if(usedNames.has(name)){
          alert("åå­—é‡å¤");
          input.value="";
          return;
        }
        usedNames.add(name);
        cell.classList.add("done");
      };
      cell.appendChild(question);
      cell.appendChild(input);
      grid.appendChild(cell);
    });

    // ä¸€é”®ç”Ÿæˆå®Œæ•´é•¿å›¾
    document.getElementById("downloadImage").onclick = async ()=>{
      const container = document.getElementById("container");
      html2canvas(container, {
        scale:1,       // scale è°ƒå°ï¼Œé¿å…å¾®ä¿¡æˆªæ–­
        useCORS:true,
        scrollY:-window.scrollY // é¿å…æˆªå–æ»šåŠ¨æ¡
      }).then(canvas=>{
        const imgData = canvas.toDataURL("image/png");
        const link = document.createElement("a");
        link.href = imgData;
        link.download = "HOMI_çƒ¤ç¾Šæ´¾å¯¹ç ´å†°æ¸¸æˆ.png";
        link.click();
        alert("å›¾ç‰‡ç”ŸæˆæˆåŠŸï¼é•¿æŒ‰ä¿å­˜æˆ–åˆ†äº«åˆ°å¾®ä¿¡ç¾¤");
      }).catch(err=>{
        console.error(err);
        alert("ç”Ÿæˆå›¾ç‰‡å¤±è´¥ï¼Œè¯·åœ¨ç”µè„‘æˆ–æ”¯æŒæµè§ˆå™¨é‡è¯•");
      });
    };
  </script>
</body>
</html>
